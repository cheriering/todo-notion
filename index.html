<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>Pink Todo Widget</title>

<style>
  body {
    background: transparent;
    font-family: "Pretendard", sans-serif;
  }

  .todo-box {
    width: 280px;
    padding: 14px;
    border-radius: 16px;
    background: #fff;
    box-shadow: 0 0 0 2px #ffd6e7;
  }

  .todo-title {
    color: #ff8fb8;
    font-size: 14px;
    margin-bottom: 8px;
  }

  .input-row {
    display: flex;
    gap: 6px;
    margin-bottom: 10px;
  }

  input[type="text"] {
    flex: 1;
    padding: 6px 8px;
    border-radius: 8px;
    border: 1px solid #ffd6e7;
    outline: none;
  }

  button {
    border: none;
    background: #ffb3cf;
    color: white;
    border-radius: 8px;
    padding: 0 10px;
    cursor: pointer;
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  li {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px;
    border-radius: 8px;
    font-size: 13px;
  }

  .text {
    flex: 1;
    text-align: left;
  }

  li.done .text {
    text-decoration: line-through;
    opacity: 0.4;
  }

  .heart {
    color: #ff5fa2;
    font-size: 14px;
  }

  .delete {
    cursor: pointer;
    opacity: 0.4;
  }
</style>
</head>

<body>

<div class="todo-box">
  <div class="todo-title">every day is day 1...♡</div>

  <div class="input-row">
    <input id="todoInput" type="text" placeholder="할 일 추가..." />
    <button onclick="addTodo()">+</button>
  </div>

  <ul id="todoList"></ul>
</div>

<script>
  const todoInput = document.getElementById("todoInput");
  const todoList = document.getElementById("todoList");

  // 데이터 불러오기 함수
  function loadTodos() {
    const saved = localStorage.getItem("pink_todo_data");
    if (saved) {
      const items = JSON.parse(saved);
      items.forEach(todo => createTodoElement(todo.text, todo.done));
    }
  }

  // 데이터 저장하기 함수
  function saveTodos() {
    const todos = [];
    todoList.querySelectorAll("li").forEach(li => {
      todos.push({
        text: li.querySelector(".text").textContent,
        done: li.classList.contains("done")
      });
    });
    localStorage.setItem("pink_todo_data", JSON.stringify(todos));
  }

  function createTodoElement(text, done = false) {
    const li = document.createElement("li");
    li.className = done ? "done" : "";
    li.innerHTML = `
      <input type="checkbox" ${done ? "checked" : ""}>
      <span class="text">${text}</span>
      <span class="heart">${done ? "♥" : "♡"}</span>
      <span class="delete">✕</span>
    `;

    const checkbox = li.querySelector("input");
    const heart = li.querySelector(".heart");
    
    checkbox.onchange = () => {
      li.classList.toggle("done", checkbox.checked);
      heart.textContent = checkbox.checked ? "♥" : "♡";
      saveTodos(); // 변경될 때마다 저장
    };

    li.querySelector(".delete").onclick = () => {
      li.remove();
      saveTodos(); // 삭제될 때마다 저장
    };

    todoList.appendChild(li);
  }

  function addTodo() {
    const text = todoInput.value.trim();
    if (text) {
      createTodoElement(text);
      todoInput.value = "";
      saveTodos();
    }
  }

  // 엔터키 지원 추가
  todoInput.addEventListener("keypress", (e) => {
    if (e.key === "Enter") addTodo();
  });

  window.onload = loadTodos;
</script>

</body>
</html>
